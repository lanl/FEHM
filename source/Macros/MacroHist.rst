========
``hist``
========

History data output selection, output timestep intervals, and time intervals. Parameters will be output for the nodes specified in the node or nod2 macro in individual files for each parameter selected. If output zones are defined (node macro) the output will be a volume weighted average for the zone. Currently zone averaged values can be output for pressure, head, temperature, and enthalpy. History files will be named using the root portion of the history file name (``root_name.his``) provided as input, e.g., pressure output would be in a file named: ``root_name_pres.his``. The named history output file will contain run information and the list of selected output nodes (with their coordinates) and zones (with node list). 

* Group 1 -	CHDUM 

or using optional input or keywords

* Group 1 -	CHDUM, NHIST, HISTIME

where CHDUM is ‘years', ‘days', ‘hrs', or ‘seconds', or

* Group 1 -	CHDUM, CHDUM1, . . . , CHDUMn

where CHDUM is mpa, pressure, density, viscosity, or global

+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Input Variable      | Format       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+=====================+==============+=============================================================================================================================================================================================================================================================================================================================================================================================================================================+
| CHDUM               | character*80 | Keyword specifying type of history plot data files to be created. Keywords are entered one per line and terminated with ‘end hist' or a blank line. Keywords must be entered starting in the 1st column. Valid keywords (case insensitive) are:                                                                                                                                                                                             |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘tecplot' - data will be output using tecplot style headers and format                                                                                                                                                                                                                                                                                                                                                                      |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘csv' or ‘surfer' - data and parameter headers will be output as comma separated variables (‘csv' format)                                                                                                                                                                                                                                                                                                                                   |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘years' - output time in years                                                                                                                                                                                                                                                                                                                                                                                                              |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘days' - output time in days                                                                                                                                                                                                                                                                                                                                                                                                                |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘hrs' - output time in hours                                                                                                                                                                                                                                                                                                                                                                                                                |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘seconds' - output time in seconds                                                                                                                                                                                                                                                                                                                                                                                                          |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘mpa' or ‘pressure' - output pressure in MPa                                                                                                                                                                                                                                                                                                                                                                                                |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘deg' or ‘temperature' - output temperature in oC                                                                                                                                                                                                                                                                                                                                                                                           |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘head' or ‘meters' - output head in meters                                                                                                                                                                                                                                                                                                                                                                                                  |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘feet' - output head in feet                                                                                                                                                                                                                                                                                                                                                                                                                |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘saturation' - output saturation                                                                                                                                                                                                                                                                                                                                                                                                            |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘wco' - water content                                                                                                                                                                                                                                                                                                                                                                                                                       |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘flow' or ‘kgs' - output flow in kg/s                                                                                                                                                                                                                                                                                                                                                                                                       |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘enthalpy' - output enthalpy in MJ/kg                                                                                                                                                                                                                                                                                                                                                                                                       |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘efl' or ‘mjs' - output enthalpy flow (MJ/s)                                                                                                                                                                                                                                                                                                                                                                                                |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘density' - output density (:math:`kg/m^3`)                                                                                                                                                                                                                                                                                                                                                                                                 |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘humidity' - output relative humidity                                                                                                                                                                                                                                                                                                                                                                                                       |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘viscosity' - output viscosity (Pa-s)                                                                                                                                                                                                                                                                                                                                                                                                       |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘zflux' - output zone fluxes                                                                                                                                                                                                                                                                                                                                                                                                                |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘concentration' - output species concentration (concentrations for each specie will be output in a separate file)                                                                                                                                                                                                                                                                                                                           |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘wt' - output water table elevation                                                                                                                                                                                                                                                                                                                                                                                                         |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘co2s' - output :math:`CO_2` saturations (volume fractions) An ‘l' or ‘g' may be appended to co2s to specify that only liquid or gas saturation should be output.                                                                                                                                                                                                                                                                           |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘co2m' - output total :math:`CO_2` mass (kg), free :math:`CO_2` mass fraction, and dissolved :math:`CO_2` mass fraction. Other wise use the form listed below to output specified quantity:                                                                                                                                                                                                                                                 |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘co2mt' - output total :math:`CO_2` mass (kg)                                                                                                                                                                                                                                                                                                                                                                                               |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘co2mf' - output free :math:`CO_2` mass fraction                                                                                                                                                                                                                                                                                                                                                                                            |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘co2md' - output dissolved :math:`CO_2` mass fraction                                                                                                                                                                                                                                                                                                                                                                                       |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘cfluxz' - output :math:`CO_2` zone fluxes                                                                                                                                                                                                                                                                                                                                                                                                  |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘displacements' - output displacements (m), ‘disx', ‘disy' or ‘disz' may be used to select only the x, y, or z displacement.                                                                                                                                                                                                                                                                                                                |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘stress' - output stresses, ‘strsx', strsy', ‘strsz', ‘strsxy', ‘strsxz' or ‘strsyz' may be used to select specific stress components.                                                                                                                                                                                                                                                                                                      |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘strain' - output strain                                                                                                                                                                                                                                                                                                                                                                                                                    |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘rel' - output a table of relative permeability values for each input model.                                                                                                                                                                                                                                                                                                                                                                |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘global' - output global parameters                                                                                                                                                                                                                                                                                                                                                                                                         |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| NHIST               | integer      | Optional: *Time step* interval for history plots (number of timesteps). Output history information each NHIST timesteps. If not entered NHIST = 1.                                                                                                                                                                                                                                                                                          |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| HISTIME             | real         | Optional: *Time* interval for history plots. In addition to output each NHIST timesteps, output history information each HISTIME. Units correspond to units specified by selected time output keyword (years, days, hours, or seconds). If not entered HISTIME = 1.e30.                                                                                                                                                                     |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| CHDUM1 . . . CHDUMn | character*80 | Optional keywords specifying selections for history plot data files to be created. Optional keywords are entered on the same line as primary keywords. If no optional keywords are used the code will determine what will be output based on problem input. Up to 3 optional keywords may be entered.                                                                                                                                       |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | Valid keywords (case insensitive) used with keyword ‘pressure' or ‘mpa' are:                                                                                                                                                                                                                                                                                                                                                                |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘total' or ‘water'- output total or water pressure                                                                                                                                                                                                                                                                                                                                                                                          |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘air' - output air pressure                                                                                                                                                                                                                                                                                                                                                                                                                 |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘capillary' - output capillary pressure                                                                                                                                                                                                                                                                                                                                                                                                     |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘co2' - output :math:`CO_2` pressure                                                                                                                                                                                                                                                                                                                                                                                                        |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | Valid keywords (case insensitive) used with keyword ‘density' or ‘viscosity' are:                                                                                                                                                                                                                                                                                                                                                           |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘water' - output water density or viscosity                                                                                                                                                                                                                                                                                                                                                                                                 |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘air' - output air/vapor density or viscosity                                                                                                                                                                                                                                                                                                                                                                                               |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘co2' - output :math:`CO_2` liquid and gas density or viscosity. An ‘l' or ‘g' may be appended to co2 to specify that only liquid or gas density should be output.                                                                                                                                                                                                                                                                          |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | Valid keywords (case insensitive) used with keyword ‘global' are:                                                                                                                                                                                                                                                                                                                                                                           |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘mass' - output mass balances only for problem (excluding steam) (used with keyword ‘global')                                                                                                                                                                                                                                                                                                                                               |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘water' - output water balances only for problem (excluding steam) (used with keyword ‘global')                                                                                                                                                                                                                                                                                                                                             |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘steam' - output mass/water balance only for problem including steam (used with keyword ‘global')                                                                                                                                                                                                                                                                                                                                           |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘air' = output air / vapor balances only for problem (used with keyword ‘global')                                                                                                                                                                                                                                                                                                                                                           |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                     |              | ‘energy' - output energy balances only for problem (used with keyword ‘global')                                                                                                                                                                                                                                                                                                                                                             |
+---------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


.. note::
  
  If a time keyword (years, days, hrs, or seconds) is not entered, output time will be in days and data will be output for each timestep. The time output keywords may be used with optional input NHIST and HISTIME.

.. note::

  If a file format keyword is being used, it must immediately follow the macro name. Alternatively, it may be entered on the macro line. The default is for the headers and data to be output using plain text and spaces.

.. note::

  If no optional keywords are used with the ‘global' keyword the code will determine which balances will be output based on problem input (mass/energy or water/air). Currently only 1 optional keyword may be used with global to specify a single balance type. Balance output includes: Total (mass, water, air in kg, energy in MJ) in system, total discharge, total input, current discharge, current input, and net discharge.

The following are examples of ``hist``. For this first example, time will be output in years and temperatures in oC. Data will be output each 100000 timesteps or at time intervals of 50 years.

+-------+--------+-----+
| hist  |        |     |
+=======+========+=====+
| years | 100000 | 50. |
+-------+--------+-----+
| deg   |        |     |
+-------+--------+-----+
| end   |        |     |
+-------+--------+-----+


In this second example, pressures in MPa (water and air) and temperatures in oC
will be written each timestep and time will be output in days. The global
mass balance for water will also be output at each time step. 

+--------+-------+-----+
| hist   |       |     |
+========+=======+=====+
| mpa    | total | air |
+--------+-------+-----+
| deg    |       |     |
+--------+-------+-----+
| global | mass  |     |
+--------+-------+-----+
| end    |       |     |
+--------+-------+-----+


