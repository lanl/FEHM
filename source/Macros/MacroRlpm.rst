========
``rlpm``
========

Relative permeability and capillary pressure model. Several models are available.

Group 1 - KEYWORD "group", GROUP_NUMBER

* The Group 1 KEYWORD "group", which starts each model sequence.

Group 2 - KEYWORD "rlp" PHASE, MODEL_TYPE, RLP_PARAM(i), i = 1, NUMP

* At minimum, one entry is made for relative permeability of the wetting phase in the model.  If an entry for a non-wetting phase is not present, Rnw will be calculated using the same model and parameters as Rw. 

Group 3 (optional) - KEYWORD "cap", COUPLE, MODEL_TYPE, CAP_PARAM(i), i = 1, NUMP

* One entry is made for each phase-couple in the model.  If absent, Cp=0

NUMP is the number of parameters needed for the selected model type (see parameter table).

Alternatively, to enter relative permeability and capillary pressure values in a table. 

Group 2 -	KEYWORD "table",  COUPLE

.. note::

  For backwards compatability with earlier versions of FEHM Group 2 can be: KEYWORD "table" Table#  PHASE1 PHASE2 COUPLE. Table#,PHASE1,& PHASE2 will be ignored.


Group 3 -	SATURATION, PHASE1 RELPERM, PHASE2 RELPERM, CAPILLARY PRESSURE


Group 3 is entered multiple times to cover the full range of wetting phase saturation (0. - 1.0).

Table input is terminated with KEYWORD ‘end' or a blank line. Note input saturation is the saturation of the wetting phase, and PHASE1 is the wetting phase. 

-or-

Group 3 -	KEYWORD "file"

	TABLE_FILE

Table data will be read from the specified file.

Model input is terminated with KEYWORD ‘end' or a blank line.



Group 4 -	JA, JB, JC, GROUP_NUMBER 


+----------------+-----------+------------------------------------------------------------------------------------------------+
| Input Variable | Format    | Description                                                                                    |
+================+===========+================================================================================================+
| KEYWORD        | character | group rlp cap                                                                                  |
+----------------+-----------+------------------------------------------------------------------------------------------------+
| GROUP_NUMBER   | integer   | Identifier for the current model.                                                              |
+----------------+-----------+------------------------------------------------------------------------------------------------+
| PHASE          | character | Fluid state: water air co2_liquid co2_sc co2_gas vapor methane_hydrate oil gas                 |
+----------------+-----------+------------------------------------------------------------------------------------------------+
| MODEL_TYPE     | character | See Tables 1-3                                                                                 |
+----------------+-----------+------------------------------------------------------------------------------------------------+
| RLP_PARAM      | real      | Input parameters for the specified relative permeability model. See Tables 1-2                 |
+----------------+-----------+------------------------------------------------------------------------------------------------+
| NUMP           | integer   | Number of parameters specified for the model (see Tables 1 and 3).                             |
+----------------+-----------+------------------------------------------------------------------------------------------------+
| COUPLING       | character | Phase couple air/water water/co2_liquid water/co2_gas co2_liquid/co2_gas water/vapor air/vapor |
+----------------+-----------+------------------------------------------------------------------------------------------------+
| CAP_PARAM      | real      |Input parameters for the specified capillary pressure model. See Table 3                        |
+----------------+-----------+------------------------------------------------------------------------------------------------+
| TBLNUM         | integer   | Table identifier.                                                                              |
+----------------+-----------+------------------------------------------------------------------------------------------------+
| PHASE1         | character | Fluid state of the wetting phase (see PHASE for phase ID)                                      |
+----------------+-----------+------------------------------------------------------------------------------------------------+
| PHASE2         | character | Fluid state of the non-wetting phase (see PHASE for phase ID)                                  |
+----------------+-----------+------------------------------------------------------------------------------------------------+


Optional parameters are shown in **bold**. 
Table 1. Relative permeability options

+-----------------------------------------------+-----------------+------+---+----------+
| Model type                                    | Input Parameter |      |   |          |
+===============================================+=================+======+===+==========+
|                                               | 1               | 2    | 3 | 4        |
+-----------------------------------------------+-----------------+------+---+----------+
| Linear                                        | Sr              | Smax |   |          |
+-----------------------------------------------+-----------------+------+---+----------+
| Exponential                                   | Sr              | Smax | λ |  **C**   |
+-----------------------------------------------+-----------------+------+---+----------+
| Corey                                         | Sr              | Smax |   |          |
+-----------------------------------------------+-----------------+------+---+----------+
| Brooks-Corey                                  | Sr              | Smax | λ |  **D**   |
+-----------------------------------------------+-----------------+------+---+----------+
| Van Genuchten (5 model type options, Table 2) | Sr              | Smax | m |          |
+-----------------------------------------------+-----------------+------+---+----------+

Table 2.  Van Genuchten Relative permeability options

+----------------------+----------------------+-----------------------+
| Keyword              | Independent variable | :math:`R_{nw}`        |
+======================+======================+=======================+
| :math:`Vg_1`         | S                    | :math:`1.-R_{w}`      |
+----------------------+----------------------+-----------------------+
| :math:`Vg`           | S                    | VG formula            |
+----------------------+----------------------+-----------------------+
| :math:`Vg_{1_{cap}}` | Cp                   | :math:`1.-R_w`        |
+----------------------+----------------------+-----------------------+
| :math:`Vg_{cap}`     | Cp                   | Roseangela            |
+----------------------+----------------------+-----------------------+
| :math:`Vg_{corey}`   | S                    | Corey formula         |
+----------------------+----------------------+-----------------------+

For dual porosity problems with Van Genuchten models, an optional line can follow the 'rlp' line with the following format:

.. code::

  KEYWORD "fracture" Sr Smax m Fracture_k Matrix_k Vf FMIT


Note: for backwards compatability with earlier versions of FEHM:

1. the following input style is accepted for all the Van Genuchten model. :math:`α_G` will be ignored.

+---------------+----+------+-------------+------+
| Van Genuchten | Sr | Smax | :math:`α_G` | n    |
+---------------+----+------+-------------+------+

.. code::

  KEYWORD "fracture" Sr Smax m α_G Fracture_k Matrix_k Vf FMIT

2. the keyword 'rlp' can be omitted.
   
   Table 3. Capillary Pressure options

+---------------+-----+-----------------+---------------+----------------+----+----+
| Model type    |     | Input Parameter |               |                |    |    |
+===============+=====+=================+===============+================+====+====+
|               | 1   | 2               | 3             | 4              | 5  | 6  |
+---------------+-----+-----------------+---------------+----------------+----+----+
| Linear        | Sr  | Smax            |               |                |    |    |
+---------------+-----+-----------------+---------------+----------------+----+----+
| Linear_for    | Cpo | Sco             |               |                |    |    |
+---------------+-----+-----------------+---------------+----------------+----+----+
| Exponential   | Sr  | Smax            | C             |                |    |    |
+---------------+-----+-----------------+---------------+----------------+----+----+
| Brooks-Corey  | Sr  | Smax            | λ             | :math:`C_{pe}` | S1 | S2 |
+---------------+-----+-----------------+---------------+----------------+----+----+
| Van Genuchten | Sr  | Smax            | :math:`α_G`   | n              | S1 | S2 |
+---------------+-----+-----------------+---------------+----------------+----+----+
    
For dual porosity problems with Van Genuchten models, an optional line can follow the 'cap' line with the following format:

.. code::

  KEYWORD "fracture" Sr Smax m 
   
   
Table 4

+--------------------+--------+-------------------------------------------------------------------------------------+
| Parameter          | Format | Description                                                                         |
+====================+========+=====================================================================================+
| Sr                 | real   | Residual (or minimum) wetting-phase saturation.                                     |
+--------------------+--------+-------------------------------------------------------------------------------------+
| Smax               | real   | Maximum wetting-phase saturation.                                                   |
+--------------------+--------+-------------------------------------------------------------------------------------+
| λ                  | real   | Exponent in exponential & Brooks-Corey models                                       |
+--------------------+--------+-------------------------------------------------------------------------------------+
| α                  | real   | Inverse of air entry head, :math:`α_G` (1/m)                                        |
+--------------------+--------+-------------------------------------------------------------------------------------+
| n                  | real   | Parameter n from van Genuchten (1980).                                              |
+--------------------+--------+-------------------------------------------------------------------------------------+
| C                  | real   | Optional constant in exponential model, =1 if omitted                               |
+--------------------+--------+-------------------------------------------------------------------------------------+
| k                  | real   | Optional constant in Brooks-Corey model, (Miller et al., 1998, pg.88) =2 if omitted |
+--------------------+--------+-------------------------------------------------------------------------------------+
| Cpo                | real   | Capillary pressure at zero saturation (MPa)                                         |
+--------------------+--------+-------------------------------------------------------------------------------------+
| So                 | real   | Saturation when Capillary pressure is zero (-)                                      |
+--------------------+--------+-------------------------------------------------------------------------------------+
| :math:`C_{pe}`     | real   | Capillary entry pressure (MPa)                                                      |
+--------------------+--------+-------------------------------------------------------------------------------------+
| Fracture_k         | real   | Fracture permeability (m2)                                                          |
+--------------------+--------+-------------------------------------------------------------------------------------+
| Matrix_k           | real   | Matrix permeability (m2)                                                            |
+--------------------+--------+-------------------------------------------------------------------------------------+
| Vf                 | real   | Fracture volume fraction                                                            |
+--------------------+--------+-------------------------------------------------------------------------------------+
| FMIT               | real   | Fracture-matrix interaction term.                                                   |
+--------------------+--------+-------------------------------------------------------------------------------------+
| S1                 | real   | VG fitting parameter                                                                |
+--------------------+--------+-------------------------------------------------------------------------------------+
| S2                 | real   | VG cutoff saturation                                                                |
+--------------------+--------+-------------------------------------------------------------------------------------+

Both Brooks-Corey and Van Genuchten models can be unstable at low saturations.  Parameters S1 and S2 can be used to provide approximations to the curves at low saturations, avoiding numerical instability.

The approximation will replace the B-C or V-G model for saturations less than S2.

If S < S2, then:

* If S1=0  (Van Genuchten model only), the curve will be forced to have zero slope at S=0

* If S1>0, Cp will vary linearly from Cp(S=S2) to Cp(S=0)=S1*Cp(S=S2) where Cp(S=S2) is capillary pressure at S=S2 calculated according to the B-C or V-G model

* If S1<0, Cp will vary linearly from Cp(S=S2) to Cp(S=0) at the slope of the Cp curve at S2 calculated according to the B-C or V-G model

Examples
--------

**Example 1**. Water Rw according to corey, non-wetting phase will be 1-Rw. Cp=0

+-------+-------+-------+-----+-----+
| rlpm  |       |       |     |     |
+=======+=======+=======+=====+=====+
| group | 1     |       |     |     |
+-------+-------+-------+-----+-----+
| rlp   | water | corey | 0.3 | 0.1 |
+-------+-------+-------+-----+-----+
| end   |       |       |     |     |
+-------+-------+-------+-----+-----+
| 1     | 140   | 1     | 1   |     |
+-------+-------+-------+-----+-----+
|       |       |       |     |     |
+-------+-------+-------+-----+-----+
 
**Example 2**. Air/Water problem.  Both water and air will have linear rlp models.  Capillary pressure of air/water will be 
according to the linear forsyth model. 

+-------+-----------+------------+------+------+---+
| rlpm  |           |            |      |      |   |
+=======+===========+============+======+======+===+
| group | 1         |            |      |      |   |
+-------+-----------+------------+------+------+---+
| rlp   | water     | linear     | 0.3  | 1.0  |   |
+-------+-----------+------------+------+------+---+
| rlp   | air       | linear     | 0.1  | .7   |   |
+-------+-----------+------------+------+------+---+
| cap   | air/water | linear_for | 93.6 | 100. |   |
+-------+-----------+------------+------+------+---+
| end   |           |            |      |      |   |
+-------+-----------+------------+------+------+---+
| 1     | 0         | 0          | 1    |      |   |
+-------+-----------+------------+------+------+---+
|       |           |            |      |      |   |
+-------+-----------+------------+------+------+---+
 
**Example 3**.  Air/Water problem.  Water (and air, by default) will both have vg rel perm model (see Table 2 for details). 
Air/water capillary pressure will be vg. 

+-------+-----------+------+--------+-----+-----+-----+----+------+---+
| rlpm  |           |      |        |     |     |     |    |      |   |
+=======+===========+======+========+=====+=====+=====+====+======+===+
| group | 10        |      |        |     |     |     |    |      |   |
+-------+-----------+------+--------+-----+-----+-----+----+------+---+
| rlp   | water     | vg_1 | 0.0001 | 1.0 | 3.0 |     |    |      |   |
+-------+-----------+------+--------+-----+-----+-----+----+------+---+
| cap   | air/water | vg   | 0.0001 | 1.0 | 3.0 | 3.0 | 2. | 0.05 |   |
+-------+-----------+------+--------+-----+-----+-----+----+------+---+
| end   |           |      |        |     |     |     |    |      |   |
+-------+-----------+------+--------+-----+-----+-----+----+------+---+
| 1     | 0         | 0    | 10     |     |     |     |    |      |   |
+-------+-----------+------+--------+-----+-----+-----+----+------+---+
|       |           |      |        |     |     |     |    |      |   |
+-------+-----------+------+--------+-----+-----+-----+----+------+---+
 
**Example 5**.  Dual porosity air/water problem.  Water (and air, by default) will both have vg rel perm model, calculated using capillary pressure as the independent variable (see Table 2 for details).  Air/water capillary pressure will be vg.  Fracture rel perm and capillary pressure models are specified, as well. 

+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| rlpm     |           |        |        |          |          |          |          |        |   |
+==========+===========+========+========+==========+==========+==========+==========+========+===+
| group    | 1         |        |        |          |          |          |          |        |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| rlp      | water     | vg_cap | 0.0212 | 1.0      | 1.62     |          |          |        |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| fracture | 0.03      | 1.0    | 3.00   | 4.06e-09 | 2.04e-18 | 2.93e-04 | 0.       |        |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| cap      | air/water | vg     | 0.0212 | 1.0      | 0.00715  | 1.62     | 2.       | 0.0312 |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| fracture | 0.03      | 1.0    | 12.05  | 3.00     | 20.0     | 0.0001   |          |        |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| group    | 2         |        |        |          |          |          |          |        |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| rlp      | water     | vg_cap | 0.154  | 1.0      | 0.371    | 2.37     |          |        |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| fracture | 0.03      | 1.0    | 13.72  | 3.00     | 7.14e-09 | 2.51e-18 | 9.27e-05 | 0.     |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| cap      | air/water | vg_cap | 0.154  | 1.0      | 0.371    | 2.37     | 2.       | 0.164  |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| fracture | 0.03      | 1.0    | 13.72  | 3.00     | 20.0     | 0.0001   |          |        |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| end      |           |        |        |          |          |          |          |        |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| -1       | 0         | 0      | 1      |          |          |          |          |        |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
| -2       | 0         | 0      | 2      |          |          |          |          |        |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
|          |           |        |        |          |          |          |          |        |   |
+----------+-----------+--------+--------+----------+----------+----------+----------+--------+---+
 
**Example 6**.  Water/vapor problem. Group 1 applies a corey relative permeability function (also applied to vapor, by default). cp=0.
Group 2 applies interpolated values from a table, read from an external file "doe_rlpm.table".  (note:  this file can be generated by FEHM
by using the keyword 'rel' in the hist macro)

+----------------------+-------------+-------+-----+-----+---+
| rlpm                 |             |       |     |     |   |
+======================+=============+=======+=====+=====+===+
| group                | 1           |       |     |     |   |
+----------------------+-------------+-------+-----+-----+---+
|rlp                   | water       | corey | 0.3 | 0.1 |   |
+----------------------+-------------+-------+-----+-----+---+
| group                | 2           |       |     |     |   |
+----------------------+-------------+-------+-----+-----+---+
| table                | water/vapor |       |     |     |   |
+----------------------+-------------+-------+-----+-----+---+
| file                 |             |       |     |     |   |
+----------------------+-------------+-------+-----+-----+---+
| input/doe_rlpm.table |             |       |     |     |   |
+----------------------+-------------+-------+-----+-----+---+
| end                  |             |       |     |     |   |
+----------------------+-------------+-------+-----+-----+---+
| 1                    | 140         | 1     | 2   |     |   |
+----------------------+-------------+-------+-----+-----+---+
|                      |             |       |     |     |   |
+----------------------+-------------+-------+-----+-----+---+

For example, the file doe_rlpm.table would contain an arbitrary number header rows (each header row must contain a character in the first column) 
followed by an arbitrary number of lines each containing the following information:
saturation, relative permeability (wetting phase), relative permeability (non-wetting phase),and capillary pressure (MPa). 

+--------------------------------------------------------+-----------------+-----------------+------------+
| FEHM V3.00pgi64 10-10-20 QA:NA 10/20/2010 14:23:18     |                 |                 |            |
+========================================================+=================+=================+============+
| *** DOE Code Comparison Project, Problem 5, Case A *** |                 |                 |            |
+--------------------------------------------------------+-----------------+-----------------+------------+
| Relative permeability and Capillary pressure           |                 |                 |            |
+--------------------------------------------------------+-----------------+-----------------+------------+
| "Saturation" "Liquid" "Vapor" "Capillary pressure"     |                 |                 |            |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.00000000                                             | 0.00000000      | 1.00000000      | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.500000000E-01                                        | 0.00000000      | 1.00000000      | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.100000000                                            | 0.00000000      | 1.00000000      | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.150000000                                            | 0.00000000      | 1.00000000      | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.200000000                                            | 0.00000000      | 1.00000000      | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.250000000                                            | 0.00000000      | 1.00000000      | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.300000000                                            | 0.732682696E-64 | 1.00000000      | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.350000000                                            | 0.482253086E-04 | 0.834442515     | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.400000000                                            | 0.771604938E-03 | 0.675154321     | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.450000000                                            | 0.390625000E-02 | 0.527343750     | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.500000000                                            | 0.123456790E-01 | 0.395061728     | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.550000000                                            | 0.301408179E-01 | 0.281201775     | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.600000000                                            | 0.625000000E-01 | 0.187500000     | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.650000000                                            | 0.115788966     | 0.114535108     | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.700000000                                            | 0.197530864     | 0.617283951E-01 | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.750000000                                            | 0.316406250     | 0.273437500E-01 | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.800000000                                            | 0.482253086     | 0.848765432E-02 | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.850000000                                            | 0.706066744     | 0.110918210E-02 | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.900000000                                            | 1.00000000      | 0.00000000      | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 0.950000000                                            | 1.00000000      | 0.00000000      | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
| 1.00000000                                             | 1.00000000      | 0.00000000      | 0.00000000 |
+--------------------------------------------------------+-----------------+-----------------+------------+
