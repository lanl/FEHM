

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Input Data &mdash; FEHM 3.3.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Output" href="Output.html" />
    <link rel="prev" title="zonn" href="Macros/MacroZonn.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> FEHM
          

          
          </a>

          
            
            
              <div class="version">
                3.3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="SystemInterface.html">System Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="SystemInterface.html#installation-instructions">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataFiles.html">Data Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="DefinitionsAndAcronyms.html">Definitions and Acronyms</a></li>
<li class="toctree-l1"><a class="reference internal" href="ExamplesAndSamples.html">Examples and Sample Problems</a></li>
</ul>
<p class="caption"><span class="caption-text">Program Specifications</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Macros.html">Macros</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Input Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-considerations">General Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#macro-control-statements-for-fehm-alphabetical-list">Macro Control Statements for FEHM (Alphabetical List)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-parameters">Input Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#individual-input-records-or-parameters">Individual Input Records or Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multiple-realization-simulations">Multiple Realization Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transfer-function-curve-data-input-file">Transfer function curve data input file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optional-input-files">Optional Input Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#option-to-disable-a-macro">Option to disable a macro</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Output.html">Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="ProgramConsiderations.html">Program Considerations</a></li>
</ul>
<p class="caption"><span class="caption-text">References &amp; Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="References.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="Support.html">User Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReleaseNotes/release_notes.html">Release Notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FEHM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Input Data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/InputData.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="input-data">
<h1>Input Data<a class="headerlink" href="#input-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general-considerations">
<h2>General Considerations<a class="headerlink" href="#general-considerations" title="Permalink to this headline">¶</a></h2>
<p><strong>Techniques</strong></p>
<p><strong>Control File or Terminal I/O Startup</strong></p>
<p>The input/output (I/O) file information is provided to the code from an input control file or the terminal. The default control file name is <code class="docutils literal notranslate"><span class="pre">fehmn.files</span></code>. If a control file with the default name is present in the directory from which the code is being executed, no terminal input is required. If the default control file is not present, it is possible to supply the name of the control file on the command line, otherwise input prompts are written to the screen preceded by a short description of the I/O files used by FEHM. It should be noted that a control file name entered on the command line will take precedence over the default control file. The descriptions of the I/O files are elaborated on in <a class="reference external" href="DataFiles.html">Data Files</a>. The initial prompt asks for the name of a control file. It is also If a control file name is entered for that prompt no further terminal input is required. If a control file is not used, the user is then prompted for I/O file names, the tty output flag, and user subroutine number. When the input file name is entered from the terminal the user has the option of letting the code generate the names for the remainder of the auxiliary files using the input file name prefix. The form of the input file name is <code class="docutils literal notranslate"><span class="pre">filen</span></code> or <code class="docutils literal notranslate"><span class="pre">filen.*</span></code> where <code class="docutils literal notranslate"><span class="pre">filen</span></code> is the prefix used by the code to name the auxiliary files and <code class="docutils literal notranslate"><span class="pre">.*</span></code> represents an arbitrary file extension.</p>
<p><strong>Multiple Realization Simulations</strong></p>
<p>The code has an option for performing multiple simulation realizations (calculations) where input (e.g., porosity, permeability, saturation, transport properties or particle distributions) is modified for each realization but the calculations are based on the same geometric model. Multiple realizations are initiated by including a file called fehmn.msim in the directory from which the code is being run. If invoked, a set number of simulations are performed sequentially, with pre- and post-processing steps carried out before and after each simulation. This capability allows multiple simulations to be performed in a streamlined fashion, with processing to change input files before each run and post-processing to obtain relevant results after each run.</p>
<p><strong>Macro Control Structure</strong></p>
<p>The finite element heat and mass transfer code (FEHM) contains a macro control structure for data input that offers added flexibility to the input process. The macro command structure makes use of a set of control statements recognized by the input module of the program. When a macro control statement is encountered in an input file, a certain set of data with a prescribed format is expected and read from the input file. In this way, the input is divided into separate, unordered blocks of data. The input file is therefore a collection of macro control statements, each followed by its associated data block. Blocks of data can be entered in any order, and any blocks unnecessary to a particular problem need not be entered. The macro control statements must appear in the first four columns of a line. The other entries are free format, which adds flexibility, but requires that values be entered for all input variables (no assumed null values).</p>
<p>As an aid to the user, the capabilities of FEHM summarized in <a class="reference external" href="ProgramConsiderations.html">Capabilities of FEHM with Macro Command References</a> refer to applicable macro commands. <a class="reference external" href="Macros.html">Macro Control Statements for FEHM</a> lists the macro control statements with a brief description of the data associated with each. A more detailed description of each macro control statement and its associated input are found in their respective pages. Macro control statements may be called more than once, if, for example, the user wishes to reset some property values after defining alternate zones. Some statements are required, as indicated in <a class="reference external" href="Macros.html">Macro Control Statements for FEHM</a>, the others are optional.</p>
</div>
<div class="section" id="macro-control-statements-for-fehm-alphabetical-list">
<span id="macros"></span><h2>Macro Control Statements for FEHM (Alphabetical List)<a class="headerlink" href="#macro-control-statements-for-fehm-alphabetical-list" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Macro</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="Macros/MacroAdif.html">adif</a></td>
<td>Air-water vapor diffusion</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroAirwater.html">airwater or air</a></td>
<td>Isothermal air-water input</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroAnpe.html">anpe</a></td>
<td>Anisotropic permeability</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroBoun.html">boun</a></td>
<td>Boundary conditions (required for flow problem if macro flow is not used)</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroBous.html">bous</a></td>
<td>Boussinesq-type approximation</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroCarb.html">carb</a></td>
<td>CO2 input</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroCden.html">cden</a></td>
<td>Concentration-dependent density</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroCflx.html">cflx</a></td>
<td>Molar flow rate through a zone</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroCgdp.html">cgdp</a></td>
<td>Rate-limited gdpm node</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroChea.html">chea</a></td>
<td>Output in terms of head, not pressures (non-head problem)</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroCond.html">cond</a></td>
<td>Thermal conductivity data (required for non-isothermal problem)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroConn.html">conn</a></td>
<td>Print number of connections for each node and stop</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroCont.html">cont</a></td>
<td>Contour plot data</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroConv.html">conv</a></td>
<td>Head input conversion for thermal problems</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroCoor.html">coor</a></td>
<td>Node coordinate data (required if macro fdm is not used)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroCtrl.html">ctrl</a></td>
<td>Program control parameters (required)</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroDpdp.html">dpdp</a></td>
<td>Double porosity/double permeability model input</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroDual.html">dual</a></td>
<td>Dual porosity model input</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroDvel.html">dvel</a></td>
<td>Velocity printout (formerly macro velo)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroElem.html">elem</a></td>
<td>Element node data (required if macro fdm is not used)</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroEos.html">eos</a></td>
<td>Simple equation of state data</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroEvap.html">evap</a></td>
<td>Evaporation model</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroExrl.html">exrl</a></td>
<td>Explicit evaluation of relative permeability</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroFdm.html">fdm</a></td>
<td>Finite difference grid generation (required if macro coor and elem are not used)</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroFinv.html">finv</a></td>
<td>Finite volume flow coefficients</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroFlgh.html">flgh</a></td>
<td>Generalized head boundary conditions (confined aquifer)</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroFlow.html">flow</a></td>
<td>Flow data (required for flow problem if macro boun is not used)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroFlo2.html">flo2</a></td>
<td>Alternate format for flow data (input using 3-D planes)</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroFlo3.html">flo3</a></td>
<td>Alternate format for flow data (defined for see page faces)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroFloa.html">floa</a></td>
<td>Alternate format for flow data (additive to previous flow definition)</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroFlwt.html">flwt</a></td>
<td>Movable source or sink (wtsi only)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroFlxn.html">flxn</a></td>
<td>Write all non-zero source/sink internodal mass flows by node to an output file.</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroFlxo.html">flxo</a></td>
<td>Internodal mass flow printout</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroFlxz.html">flxz</a></td>
<td>Zone based mass flow output</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroFper.html">fper</a></td>
<td>Permeability scaling factor</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroFrlp.html">frlp</a></td>
<td>Relative permeability factors for residual air effect</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroFtsc.html">ftsc</a></td>
<td>Flux correction for saturations over 1</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroGdkm.html">gdkm</a></td>
<td>Generalized dual permeability model</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroGdpm.html">gdpm</a></td>
<td>Generalized dual porosity model</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroGrad.html">grad</a></td>
<td>Gradient model input</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroHcon.html">hcon</a></td>
<td>Set solution to heat conduction only</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroHead.html">head</a></td>
<td>Hydraulic head input</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroHflx.html">hflx</a></td>
<td>Heat flow input</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroHist.html">hist</a></td>
<td>User selected history output</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroHyco.html">hyco</a></td>
<td>Hydraulic conductivity input (required if macro perm is not used)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroIce.html">ice or meth</a></td>
<td>Ice phase calculations, methane hydrate input</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroImex.html">imex</a></td>
<td>implicit-explicit solution</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroImpf.html">impf</a></td>
<td>Time step control based on maximum allowed variable change</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroInit.html">init</a></td>
<td>Initial value data (required if macro pres or restart file is not used)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroIntg.html">intg</a></td>
<td>Set integration type for finite element coefs</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroIsot.html">isot</a></td>
<td>Isotropic definition of control volume/finite element coefficients</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroIter.html">iter</a></td>
<td>Iteration parameters</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroItfc.html">itfc</a></td>
<td>Flow and transport between zone interfaces</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroIttm.html">ittm</a></td>
<td>Sticking time for phase changes</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroItup.html">itup</a></td>
<td>Iterations used with upwinding</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroIupk.html">iupk</a></td>
<td>Upwind transmissibility including intrinsic permeability</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroIvfc.html">ivfc</a></td>
<td>Enable exponential fracture and volume model</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroMdnode.html">mdnode</a></td>
<td>Enables extra connections to be made to nodes</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroIce.html">meth or ice</a></td>
<td>Methane hydrate input</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroMptr.html">mptr</a></td>
<td>Multiple species particle tracking simulation input</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroNfinv.html">nfinv</a></td>
<td>Finite element instead of finite volume calculations</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroNgas.html">ngas</a></td>
<td>Noncondensible gas (air) data</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroNobr.html">nobr</a></td>
<td>Don’t break connection between nodes with boundary conditions</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroNode.html">node</a></td>
<td>Node numbers for output and time histories</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroNod2.html">nod2</a></td>
<td>Node numbers for output and time histories, and alternate nodes for terminal output</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroNod3.html">nod3</a></td>
<td>Node numbers for output and time histories, alternate nodes for terminal output, and alternate nodes for variable porosity model information</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroNrst.html">nrst</a></td>
<td>Stop NR iterations on variable changes</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroPara.html">para</a></td>
<td>Parallel FEHM (isothermal only)</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroPerm.html">perm</a></td>
<td>Permeability input (required if macro hyco is not used)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroPest.html">pest</a></td>
<td>Parameter estimation routine output</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroPhys.html">phys</a></td>
<td>Non-darcy well flow</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroPpor.html">ppor</a></td>
<td>Pressure and temperature dependent porosity and permeability</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroPres.html">pres</a></td>
<td>Initial pressure, temperature, and saturation data, boundary conditions specification (required if macro init or restart file is not used)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroPtrk.html">ptrk</a></td>
<td>Particle tracking simulation input</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroRenu.html">renu</a></td>
<td>Renumbers nodes</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroRest.html">rest</a></td>
<td>Manage restart options</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroRflo.html">rflo</a></td>
<td>Read in flux values</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroRich.html">rich</a></td>
<td>Enable Richards’ equation</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroRive.html">rive or well</a></td>
<td>River or implicit well package</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroRlp.html">rlp</a></td>
<td>Relative permeability input (required for 2-phase problem if macro rlpm is not used, otherwise optional)</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroRlpm.html">rlpm</a></td>
<td>Alternate style relative permeability input (required for 2-phase problem if macro rlp is not used, otherwise optional)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroRock.html">rock</a></td>
<td>Rock density, specific heat, and porosity input (required)</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroRxn.html">rxn</a></td>
<td>Chemical reaction rate model input</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroSol.html">sol</a></td>
<td>Solver specifications</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroSptr.html">sptr</a></td>
<td>Streamline particle tracking simulation input</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroStea.html">stea</a></td>
<td>Steady state program termination</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroStop.html">stop</a></td>
<td>Signals the end of input (required)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroStrs.html">strs</a></td>
<td>Stress solution enabled</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroSubm.html">subm</a></td>
<td>Submodel boundary condition output</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroSvar.html">svar</a></td>
<td>Enable pressure-enthalpy variables</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroText.html">text</a></td>
<td>Text input to be written to output file</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroThic.html">thic</a></td>
<td>Variable thickness input for two-dimensional problems</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroTime.html">time</a></td>
<td>Time step and time of simulation data (required)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroTrac.html">trac</a></td>
<td>Solute simulation input</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroTrxn.html">trxn</a></td>
<td>A user-friendly replacement for [[wiki:MacroTra</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroUser.html">user</a></td>
<td>User subroutine call</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroVapl.html">vapl</a></td>
<td>Vapor pressure lowering</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroVbou.html">vbou</a></td>
<td>read non-pyhsical gridblock volumes</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroVcon.html">vcon</a></td>
<td>Variable thermal conductivity input</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroWeli.html">weli</a></td>
<td>Peaceman type well impedance</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroRive.html">well or rive</a></td>
<td>Implicit well package or River</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroWgtu.html">wgtu</a></td>
<td>Areas, weights (user-defined) for boundary conditions</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroWflo.html">wflo</a></td>
<td>Alternate submodel boundary output</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroWtsi.html">wtsi</a></td>
<td>Water table, simplified</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroZneg.html">zneg</a></td>
<td>Problem solving tool removes negative coefs</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroZone.html">zone</a></td>
<td>Geometric definition of grid for input parameter assignment</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroZonn.html">zonn</a></td>
<td>Same as zone, except zonn definitions are not overwritten</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Old Macros</th>
<th class="head">Original Description, current behavior is undefined.</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="Macros/MacroAlti.html">alti</a></td>
<td>Alternate element and coordinate input, grid format out of date.</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroAlti.html">dof</a></td>
<td>no longer used</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroAlti.html">exuz</a></td>
<td>no longer used</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroAlti.html">dof</a></td>
<td>no longer used</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroSzna.html">naple or szna</a></td>
<td>Isothermal water input, enable simplified napl solution</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroRflx.html">rflx</a></td>
<td>Radiation source term</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroAlti.html">solv</a></td>
<td>no longer used</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="Macros/MacroAlti.html">wlbr</a></td>
<td>no longer used, replaced by [[wiki:MacroRiv</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="Macros/MacroZeol.html">zeol</a></td>
<td>Zeolite water balance input</td>
</tr>
</tbody>
</table>
<p id="comment">Comments may be entered in the input file by beginning a line with a <code class="docutils literal notranslate"><span class="pre">#</span></code> symbol (the <code class="docutils literal notranslate"><span class="pre">#</span></code> symbol must be found in the first column of the line). Comments may precede or follow macro blocks but may not be found within a block.</p>
<p>Optional input files may be used by substituting a keyword and file name in the main input file (described in detail in <a class="reference internal" href="#optional-input-files">Optional Input Files</a>). The normal macro input is then entered in the auxiliary file.</p>
<p>A macro may be disabled (turned off or omitted from a run) by adding keyword “off” on the macro line and terminating the macro with an end statement of the form <code class="docutils literal notranslate"><span class="pre">end//macro//</span></code> or <code class="docutils literal notranslate"><span class="pre">end</span> <span class="pre">//macro//</span></code> (see <a class="reference internal" href="#option-to-disable-a-macro">Option to disable a macro</a>).</p>
</div>
<div class="section" id="input-parameters">
<span id="inputdataja"></span><h2>Input Parameters<a class="headerlink" href="#input-parameters" title="Permalink to this headline">¶</a></h2>
<p>Many input parameters such as porosity or permeability vary throughout the grid and need to have different values assigned at different nodes. This is accomplished in two ways. The first uses a nodal loop-type definition (which is the default):</p>
<blockquote>
<div>JA, JB, JC, PROP1, PROP2, …</div></blockquote>
<p>where</p>
<blockquote>
<div><p>JA - first node to be assigned with the properties PROP1, PROP2, …</p>
<p>JB - last node to be assigned with the properties PROP1, PROP2, …</p>
<p>JC -  loop increment for assigning properties PROP1, PROP2, ….</p>
<p>PROP1, PROP2, etc. - property values to be assigned to the indicated nodes.</p>
</div></blockquote>
<p>In the input blocks using this structure, one or more properties are manually entered in the above structure. When a blank line is entered, that input block is terminated and the code proceeds to the next group or control statement. (Note that blank input lines are shaded in the examples shown in <a class="reference internal" href="#individual-input-records-or-parameters">Individual Input Records or Parameters</a>.) The nodal definition above is useful in simple geometries where the node numbers are easily found. Boundary nodes often come at regular node intervals and the increment counter JC can be adjusted so the boundary conditions are easily entered. To set the same property values at every node, the user may set JA and JC to 1 and JB to the total number of nodes, or alternatively set <code class="docutils literal notranslate"><span class="pre">JA</span> <span class="pre">=</span> <span class="pre">1</span></code>, and <code class="docutils literal notranslate"><span class="pre">JB</span> <span class="pre">=</span> <span class="pre">JC</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<p>For dual porosity problems, which have three sets of parameter values at any nodal position, nodes 1 to N [where N is the total number of nodes in the grid (see macro <a class="reference external" href="MacroCoor.html">coor</a>)] represent the fracture nodes, nodes N + 1 to 2N are generated for the second set of nodes, the first matrix material, and nodes 2N + 1 to 3N for the third set of nodes, the second matrix material. For double porosity/double permeability problems, which have two sets of parameter values at any nodal position, nodes 1 to N represent the fracture nodes and nodes N + 1 to 2N are generated for the matrix material.</p>
<p>For more complicated geometries, such as 3-D grids, the node numbers are often difficult to determine. Here a geometric description is preferred. To enable the geometric description the <a class="reference external" href="MacroZone.html">zone</a> control statement <a class="reference external" href="MacroWgtu.html">wgtu</a> is used in the input file before the other property macro statements occur. The input macro <strong>zone</strong> requires the specification of the coordinates of 4-node parallelograms for 2-D problems or 8-node polyhedrons in 3-D. In one usage of the control statement <strong>zone</strong> all the nodes are placed in geometric zones and assigned an identifying number. This number is then addressed in the property input macro commands by specifying a JA &lt; 0 in the definition of the loop parameters given above. For example if JA = -1, the properties defined on the input line would be assigned to the nodes defined as belonging to geometric Zone 1 (JB and JC must be input but are ignored in this case). The control statement <strong>zone</strong> may be called multiple times to redefine geometric groupings for subsequent input. The previous zone definitions are not retained between calls. Up to 1000 zones may be defined. For dual porosity problems, which have three sets of parameter values at any nodal position, Zone <code class="docutils literal notranslate"><span class="pre">ZONE_DPADD</span> <span class="pre">+</span> <span class="pre">I</span></code> is the default zone number for the second set of nodes defined by Zone I, and Zone <code class="docutils literal notranslate"><span class="pre">2*ZONE_DPADD</span> <span class="pre">+</span> <span class="pre">I</span></code> is the default zone number for the third set of nodes defined by Zone I. For double porosity/double permeability problems, which have two sets of parameter values at any nodal position, Zone <code class="docutils literal notranslate"><span class="pre">ZONE_DPADD</span> <span class="pre">+</span> <span class="pre">I</span></code> is the default zone number for the second set of nodes defined by Zone I. The value of <code class="docutils literal notranslate"><span class="pre">ZONE_DPADD</span></code> is determined by the number of zones that have been defined for the problem. If less than 100 zones have been used <code class="docutils literal notranslate"><span class="pre">ZONE_DPADD</span></code> is set to 100, otherwise it is set to 1000. Zones of matrix nodes may also be defined independently if desired.</p>
<p>Alternatively, the <a class="reference external" href="MacroZonn.html">zonn</a> control statement may be used for geometric descriptions. Regions are defined the same as for control statement zone except that previous zone definitions are retained between calls unless specifically overwritten.</p>
<p><strong>Interface</strong></p>
<p>To interface with <a class="reference external" href="http://en.wikipedia.org/wiki/GoldSim">GoldSim</a>, FEHM is compiled as a dynamic link library (DLL) subroutine that is called by the GoldSim code. When FEHM is called as a subroutine from GoldSim, the GoldSim software controls the time step of the simulation, and during each call, the transport step is carried out and the results passed back to GoldSim for processing and/or use as radionuclide mass input to another portion of the GoldSim system, such as a saturated zone transport submodel. The interface version of FEHM is set up only to perform particle tracking simulations of radionuclide transport, and is not intended to provide a comprehensive flow and transport simulation capability for GoldSim. Information concerning the GoldSim user interface may be found in the GoldSim documentation (Golder Associates, 2002).</p>
<p><strong>Consecutive Cases</strong></p>
<p>Consecutive cases can be run using the multiple realizations simulation option (see <a class="reference internal" href="#multiple-realization-simulations">Multiple Realization Simulations</a>). The program retains only the geometric information between runs (i.e., the grid and coefficient information). The values of all other variables are reinitialized with each run, either from the input files or a restart file when used.</p>
<p><strong>Defaults</strong></p>
<p>Default values are set during the initialization process if overriding input is not provided by the user.</p>
</div>
<div class="section" id="individual-input-records-or-parameters">
<h2>Individual Input Records or Parameters<a class="headerlink" href="#individual-input-records-or-parameters" title="Permalink to this headline">¶</a></h2>
<p>Other than the information provided through the control file or terminal I/O and the multiple realization simulations file, the main user input is provided using macro control statements in the input file, geometry data file, zone data file, and optional input files. Data provided in the input files is entered in free format with the exception of the macro control statements and keywords which must appear in the first four (or more) columns of a line. Data values may be separated with spaces, commas, or tabs. The primary input file differs from the others in that it begins with a title line (80 characters maximum) followed by input in the form of the macro commands. Each file containing multiple macro commands should be terminated with the <a class="reference external" href="MacroStop.html">stop</a> control statement. In the examples provided in the following subsections, blank input lines are depicted with shading.</p>
<p><strong>Control File or Terminal I/O Input</strong></p>
<p>The file name parameters enumerated below <code class="docutils literal notranslate"><span class="pre">[nmfil(2-13)]</span></code>, are entered in order one per line in the control file (excluding the control file name <code class="docutils literal notranslate"><span class="pre">[nmfil(1)]</span></code> and error file name <code class="docutils literal notranslate"><span class="pre">[nmfil(14)]</span></code>) or in response to a prompt during terminal input. If there is a control file with the name fehmn.files in your local space (current working directory), FEHM will execute using that control file and there will be no prompts. If another name is used for the control file, it can be entered on the command line or at the first prompt.</p>
<p>A blank line can be entered in the control file for any auxiliary files not required, for the “none” option for tty output, and for the “0” option for the user subroutine number.</p>
<p>In version 2.30 an alternate format for the control file has been introduced that uses keywords to identify which input and output files will be used. Please note that the file name input styles may not be mixed.</p>
<blockquote>
<div>Group 1: <code class="docutils literal notranslate"><span class="pre">NMFIL(i)</span></code> (a file name for each i = 2 to 13)</div></blockquote>
<p>or</p>
<blockquote>
<div><p>Group 1: <code class="docutils literal notranslate"><span class="pre">KEYWORD:</span> <span class="pre">NMFIL</span></code></p>
<p>Group 2: <code class="docutils literal notranslate"><span class="pre">TTY_FLAG</span></code></p>
<p>Group 3: <code class="docutils literal notranslate"><span class="pre">USUB_NUM</span></code></p>
</div></blockquote>
<p>Unlike previous versions of the code, if a file name is not entered for the output file, check file, or restart file, the file will not be generated. An error output file will still be generated for all runs (default name <code class="docutils literal notranslate"><span class="pre">fehmn.err</span></code>). However, with the keyword input style the user has the option of naming the error file. File names that do not include a directory or subdirectory name, will be located in the current working directory. With keyword input a root filename may be entered for output files that use file name generation (hist macro output, cont macro avs, surfer or tecplot output, etc.). The data files are described in more detail in <a class="reference external" href="DataFiles.html">Data Files</a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="2%" />
<col width="2%" />
<col width="5%" />
<col width="91%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Input Variable</th>
<th class="head">Format</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>keyword</td>
<td>character*5</td>
<td>No keywords, old style file format is used</td>
<td>Keyword specifying input or output file type. The keyword is entered followed immediately by a “:” with a “space” preceding the filename. Keywords, which must be entered starting in the first column, are:</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>input    -   Main input filegrid -   Geometry data file; or grida or gridf - Ascii formatted geometry file; or gridu or gridb - Unformatted geometry filezone    -   Initial zone fileoutp   -   Output filersti -   Restart input filersto  -   Restart output filehist -   Simulation history outputtrac   -   Solute history outputcont   -   Contour outputdual, dpdp - Dual porosity, double porosity outputstor    -   Coefficient storage filecheck   –  Input check output filenopf -   Symbolic factorization filecolu -   Column data file for free surface problemserror -   Error output fileroot   -   Root name for output file name generationco2i   -   CO,,2,, parameter data file (default co2_interp_table.txt)look  -   Equation of state data lookup table file (default lookup.in)</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>Keyword file name input is terminated with a blank line. The keywords and file names may be entered in any order unlike the old style input.</td>
</tr>
<tr class="row-odd"><td>nmfil</td>
<td>character*100</td>
<td>&#160;</td>
<td>Input or output file name</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>fehmn.files</td>
<td>nmfil( 1) - Control file name (this file is not included in the old style control file) (optional)</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>fehmn.dat</td>
<td>nmfil( 2) - Main input file name (required)</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>not used</td>
<td>nmfil( 3) - Geometry data input file name (optional)</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>not used</td>
<td>nmfil( 4) - Zone data input file name (optional)</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>not used</td>
<td>nmfil( 5) - Main output file name (optional)</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>not used</td>
<td>nmfil( 6) - Restart input file name (optional)</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>not used</td>
<td>nmfil( 7) - Restart output file name (optional)</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>not used</td>
<td>nmfil( 8) - Simulation history output file name (optional)</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>not used</td>
<td>nmfil( 9) - Solute history output file name (optional)</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>not used</td>
<td>nmfil(10) - Contour plot output file name (optional)</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>not used</td>
<td>nmfil(11) - Dual porosity or double porosity / double permeability contour plot output file name (optional)</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>not used</td>
<td>nmfil(12) - Coefficient storage file name (optional)</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>not used</td>
<td>nmfil(13) - Input check output file name (optional)</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>fehmn.err</td>
<td>nmfil(14) - Error output file name (this file is not included in the old style control file). The default name is used if not input.</td>
</tr>
<tr class="row-even"><td>tty_flag</td>
<td>character*4</td>
<td>none</td>
<td>Terminal output flag: all, some, none</td>
</tr>
<tr class="row-odd"><td>usub_num</td>
<td>integer</td>
<td>0</td>
<td>User subroutine call number</td>
</tr>
</tbody>
</table>
<p>The following are examples of the input control file. The first example (left) uses keyword style input, while the second and third examples (right) use the original style control file input form. In the first example, four files are explicitly named, the input file, geometry file, tracer history output file and output error file. A root file name is also provided for file name generation. The “all” keyword indicates that all information should be written to the terminal and the ending “0” indicates that the user subroutine will not be called. In the second example in the center, all input will be found in the current working directory and output files will also be written to that directory. The blank lines indicate that there is no restart initialization file or restart output file, a dual porosity contour plot file is not required, and the coefficient storage file is not used. The “some” keyword indicates that selected information is output to the terminal. The ending “0” indicates that the user subroutine will not be called. In the third example on the right, input will be found in the “groupdir” directory, while output will be written to the current working directory. The “none” keyword indicates that no information should be written to the terminal and the ending “0” indicates that the user subroutine will not be called.</p>
<p>Files <code class="docutils literal notranslate"><span class="pre">fehmn.files</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="3%" />
<col width="19%" />
<col width="3%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>input: /groupdir/c14-3</td>
<td>&#160;</td>
<td>tape5.dat</td>
<td>&#160;</td>
<td>/groupdir/c14-3</td>
</tr>
<tr class="row-even"><td>trac: c14-3.trc</td>
<td>&#160;</td>
<td>tape5.dat</td>
<td>&#160;</td>
<td>/groupdir/grid-402</td>
</tr>
<tr class="row-odd"><td>grid: /groupdir/grid-402</td>
<td>&#160;</td>
<td>tape5.dat</td>
<td>&#160;</td>
<td>/groupdir/c14-3</td>
</tr>
<tr class="row-even"><td>root: c14-3</td>
<td>&#160;</td>
<td>tape5.out</td>
<td>&#160;</td>
<td>c14-3.out</td>
</tr>
<tr class="row-odd"><td>error: c14-3.err</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>/groupdir/c14-3.ini</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>c14-3.fin</td>
</tr>
<tr class="row-odd"><td>all</td>
<td>&#160;</td>
<td>tape5.his</td>
<td>&#160;</td>
<td>c14-3.his</td>
</tr>
<tr class="row-even"><td>0</td>
<td>&#160;</td>
<td>tape5.trc</td>
<td>&#160;</td>
<td>c14-3.trc</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>tape 5.con</td>
<td>&#160;</td>
<td>c14-3.con</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>c14-3.dp</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>c14-3.stor</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>tape5.chk</td>
<td>&#160;</td>
<td>c14-3.chk</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>some</td>
<td>&#160;</td>
<td>none</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>0</td>
<td>&#160;</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="multiple-realization-simulations">
<h2>Multiple Realization Simulations<a class="headerlink" href="#multiple-realization-simulations" title="Permalink to this headline">¶</a></h2>
<p>The multiple realization simulations input file (fehmn.msim) contains the number of simulations to be performed and, on UNIX systems, instructions for pre- and post-processing input and output data during a multiple realization simulation. The file uses the following input format:</p>
<p>Line 1  nsim</p>
<p>Lines 2-N       single_line</p>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="4%" />
<col width="91%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Input Variable</th>
<th class="head">Format</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>nsim</td>
<td>integer</td>
<td>Number of simulation realizations to be performed</td>
</tr>
<tr class="row-odd"><td>single_line</td>
<td>character*80</td>
<td>An arbitrary number of lines of UNIX shell script or Windows bat file instructions: lines 2-n:lines which are written to a file called fehmn.pre (UNIX) or fehmn.pre.bat (Windows), which is invoked before each realization using the following command: sh fehmn.pre $1 $2 (UNIX systems) or fehmn.pre.bat $1 $2 (Windows)</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>line n+1: the keyword ‘post’, placed in the first four columns of the input file, denotes that the previous line is the last line in the fehmn.pre script, and that the data for the post-processing script fehmn.post follows</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>lines n+2 to N: lines which are written to a file called fehmn.post (UNIX) or fehmn.post.bat (Windows), which is invoked after each realization using the following command: sh fehmn.post $1 $2 (UNIX) or fehmn.post.bat $1 $2 (Windows)</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>Thus, the files fehmn.pre and fehmn.post are created by the code and are meant to provide the capability to perform complex pre- and post-processing steps during a multiple realization simulation. Script arguments $1 and $2 represent the current simulation number and nsim, the total number of simulations, respectively.</td>
</tr>
</tbody>
</table>
<p>In the following (UNIX style) example, 100 simulations are performed with pre and post-processing steps carried out. File “fehmn.msim” contains the following:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span>echo This is run number $1 of $2
rm fehmn.filescurnum=`expr $1`
cp control.run fehmn.filesrm ptrk.inputcp ptrk.np$curnum ptrk.input
echo starting up the run
post
curnum=`expr $1`/home/robinson/fehm/chun_li/ptrk/process1_fujrm
np$curnum.outputmv results.output np$curnum.output
echo finishing the run again
</pre></div>
</div>
<p>The first line after the number of simulations demonstrates how the current and total number of simulations can be accessed in the fehmn.pre shell script. This line will write the following output for the first realization:</p>
<p>This is run number 1 of 100</p>
<p>The pre-processing steps in this example are to remove the fehmn.files file from the working directory, copy a control file to fehmn.files, copy a particle tracking macro input file to a commonly named file called ptrk.input, and write a message to the screen. The fehmn.files files should be used or else the code will require screen input of the control file name for every realization. One hundred particle tracking input files would have been generated previously, and would have the names ptrk.np1, ptrk.np2, …, ptrk.np100. Presumably, these files would all have different transport parameters, resulting in 100 different transport realizations. The post-processing steps involve executing a post-processor program for the results (process1_fuj). This post-processor code generates an output file called results.output, which the script changes to np1.output, np2.output, …, np100.output, for further processing after the simulation.</p>
<p>One other point to note is that the variable “curnum” in this example is defined twice, once in the pre-processor and again in the post-processor. This is necessary because fehmn.pre and fehmn.post are distinct shell scripts that do not communicate with one another.</p>
</div>
<div class="section" id="transfer-function-curve-data-input-file">
<h2>Transfer function curve data input file<a class="headerlink" href="#transfer-function-curve-data-input-file" title="Permalink to this headline">¶</a></h2>
<p>In the FEHM particle tracking models, diffusion of solute from primary porosity into the porous matrix is captured using an upscaling procedure designed to capture the small scale behavior within the field scale model. The method is to impart a delay to each particle relative to that of a nondiffusing solute. Each particle delay is computed probabilistically through the use of transfer functions. A transfer function represents the solution to the transport of an idealized system with matrix diffusion at the sub-grid-block scale. After setting up the idealized model geometry of the matrix diffusion system, a model curve for the cumulative distribution of travel times through the small-scale model is computed, either from an analytical or numerical solution. Then, this probability distribution is used to determine, for each particle passing through a given large-scale grid block, the travel time of a given particle. Sampling from the distribution computed from the small scale model ensures that when a large number of particles pass through a cell, the desired distribution of travel times through the model is reproduced. In FEHM, there are equivalent continuum and dual permeability formulations for the model, each of which call for a different set of sub-grid-block transfer function curves. These curves are numerical input to the FEHM, with a data structure described below. Optional input in macros mptr, ptrk, and sptr is used to tell the code when transfer function curves are required and whether 2 or 3 (numparams) parameter curves are to be used.</p>
<table border="1" class="docutils">
<colgroup>
<col width="2%" />
<col width="1%" />
<col width="97%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Input Variable</th>
<th class="head">Format</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>DUMMY_STRING</td>
<td>character*4</td>
<td>If keyword “free” is input at the beginning of the file, the code assumes an irregular distribution of transfer function parameters and performs either a nearest neighbor search to choose the transfer function curve, or a more computationally intensive multi-curve interpolation.</td>
</tr>
<tr class="row-odd"><td>NCURVES</td>
<td>integer</td>
<td>Total number of transfer function curves input in the file when keyword “free” is used.</td>
</tr>
<tr class="row-even"><td>LOG_FLAG</td>
<td>integer</td>
<td>Array of flags to denote whether to take the natural log of the parameter before determining the distance from the input parameter to the values for each transfer function when keyword “free” is used. If 0, use the input value, if 1, use ln(value).</td>
</tr>
<tr class="row-odd"><td>NORMAL_PARAM</td>
<td>real</td>
<td>Array of values for normalizing the parameters before performing the nearest neighbor or multi-curve interpolation. Each value is divided by NORMAL_PARAM(i) if LOG_FLAG is 0, and ln(LOG_FLAG) if LOG_FLAG is 1.</td>
</tr>
<tr class="row-even"><td>CURVE_STRUCTURE</td>
<td>integer</td>
<td>Flag to denote the type of interpolation to be performed when keyword “free” is used. If 1, simple nearest neighbor search, if &gt; 1, a multi-curve interpolation is performed with curve_strucuture points nearest to the input values of the parameters. It is recommended that values no greater than 4 be used.</td>
</tr>
<tr class="row-odd"><td>WEIGHT_FACTOR</td>
<td>real</td>
<td>Optional wieght factor used when CURVE_STRUCTURE &gt; 1. The default value is 1e-3. When determining the interpolated value of time using a multi-curve interpolation there are occasions where the algorithm yields large values of the weights used to compute the particle residence time. In a few such cases numerical errors can make the scheme fail so that the interpolated values for time erroneously get very large. This occurs when the sum of the weights divided by any individual weight is small, that is, large weights of opposite sign cancelling one another out. To prevent this error in the scheme from affecting the results, the code reverts to a nearest neighbor approach to obtain the time. The criterion for this option is that the sum of the weights divided by any individual weight is less than weight_factor. Increasing this value to 1.e-2 or higher can eliminate such occurrences. This parameter is very problem dependent, so this parameter is included for flexibility. It is recommended that the default of 1.e-3 or a higher value of 1.e-2 or so be used.</td>
</tr>
<tr class="row-even"><td>NUMP1</td>
<td>integer</td>
<td>Number of parameter 1 values used to define transfer function curves.</td>
</tr>
<tr class="row-odd"><td>PARAM1</td>
<td>real</td>
<td>nump1 parameter 1 values defining transfer function curves.</td>
</tr>
<tr class="row-even"><td>NUMP2</td>
<td>integer</td>
<td>Number of parameter 2 values used to define transfer function curves.</td>
</tr>
<tr class="row-odd"><td>PARAM2</td>
<td>real</td>
<td>nump2 parameter 2 values defining transfer function curves.</td>
</tr>
<tr class="row-even"><td>NUMP3</td>
<td>integer</td>
<td>Number of parameter 3 values used to define transfer function curves.</td>
</tr>
<tr class="row-odd"><td>PARAM3</td>
<td>real</td>
<td>nump3 parameter 3 values defining transfer function curves.</td>
</tr>
<tr class="row-even"><td>D4</td>
<td>integer</td>
<td>Fracture-matrix flow interaction flag (d4 = 1, 4). For the three-parameter option, the dual permeability model requires four transfer function curves for each set of parameters. Interactions can occur from fracture-fracture (d4=1), fracture-matrix (d4=2), matrix-fracture (d4=3), and matrix-matrix (d4=4).</td>
</tr>
<tr class="row-odd"><td>NUMP_MAX</td>
<td>integer</td>
<td>Maximum number of delay time and concentration values for transfer function curves.</td>
</tr>
<tr class="row-even"><td>NUMP</td>
<td>integer</td>
<td>Number of delay time and concentration values in each transfer function curve (nump1, nump2, nump3, d4).</td>
</tr>
<tr class="row-odd"><td>DTIME</td>
<td>real</td>
<td>Transfer function curve delay times (nump1, nump2, nump3, d4, nump).</td>
</tr>
<tr class="row-even"><td>CONC</td>
<td>real</td>
<td>Transfer function curve concentrations (nump1, nump2, nump3, d4, nump).</td>
</tr>
<tr class="row-odd"><td>OUTPUT_FLAG</td>
<td>character*3</td>
<td>If optional keyword “out” is entered at the end of the file the code outputs information on the parameter space encountered during the simulation in the <a href="#id9"><span class="problematic" id="id10">*</span></a>.out file. See [[wiki:MacroMptr</td>
</tr>
</tbody>
</table>
<p>The transfer function curve data file uses the following format if a regular grid of parameters is input. Please note that parameter values for this format should be input from smallest to largest value:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nump1</span>

<span class="n">param1</span> <span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="n">nump1</span>

<span class="n">nump2</span>

<span class="n">param2</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="n">nump2</span>
</pre></div>
</div>
<p>If 2 parameter curves are being input</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nump_max</span>

<span class="n">For</span> <span class="n">each</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="p">(</span><span class="n">nump3</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">d4</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">nump</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">param1</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">param2</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>

<span class="n">followed</span> <span class="n">by</span> <span class="k">for</span> <span class="n">each</span> <span class="n">nump</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">time</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nump</span><span class="p">),</span> <span class="n">conc</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nump</span><span class="p">)</span>
</pre></div>
</div>
<p>Or if 3 parameter curves are being input</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nump3</span>

<span class="n">param3</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="n">nump3</span>

<span class="n">nump_max</span>

<span class="n">For</span> <span class="n">each</span> <span class="n">d4</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>

<span class="n">nump</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">d4</span><span class="p">),</span> <span class="n">param1</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">param2</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="n">param3</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">d4</span>

<span class="n">followed</span> <span class="n">by</span> <span class="k">for</span> <span class="n">each</span> <span class="n">nump</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">d4</span><span class="p">)</span>

<span class="n">time</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">nump</span><span class="p">),</span> <span class="n">conc</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">nump</span><span class="p">)</span>

<span class="n">out_flag</span> <span class="p">(</span><span class="n">optional</span><span class="p">)</span> <span class="o">-</span> <span class="n">keyword</span> <span class="s2">&quot;out&quot;</span>
</pre></div>
</div>
<p>The transfer function curve data file uses the following format for the case in which the transfer functions are input without a regular grid of parameters:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dummy_flag</span> <span class="o">-</span> <span class="n">keyword</span> <span class="s2">&quot;free&quot;</span>

<span class="n">log_flag</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="n">numparams</span>

<span class="n">normal_param</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="n">numparams</span>

<span class="n">curve_structure</span><span class="p">,</span> <span class="n">weight_factor</span> <span class="p">(</span><span class="n">optional</span><span class="p">)</span>

<span class="n">ncurves</span>

<span class="n">nump_max</span>
</pre></div>
</div>
<p>For “free” form input of transfer function curves <code class="docutils literal notranslate"><span class="pre">(nump1</span> <span class="pre">=</span> <span class="pre">ncurves,</span> <span class="pre">nump2</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">and</span> <span class="pre">nump3</span> <span class="pre">=</span> <span class="pre">1)</span></code></p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">If</span> <span class="mi">2</span> <span class="n">parameter</span> <span class="n">curves</span> <span class="n">are</span> <span class="n">being</span> <span class="nb">input</span>

<span class="n">For</span> <span class="n">each</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="n">to</span> <span class="n">ncurve</span> <span class="p">(</span><span class="n">d4</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">nump</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">param1</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">param2</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">followed</span> <span class="n">by</span> <span class="k">for</span> <span class="n">each</span> <span class="n">nump</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">time</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nump</span><span class="p">),</span> <span class="n">conc</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nump</span><span class="p">)</span>
</pre></div>
</div>
<p>Or if 3 parameter curves are being input</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">For</span> <span class="n">each</span> <span class="n">d4</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="mi">4</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="n">ncurve</span>

<span class="n">nump</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d4</span><span class="p">),</span> <span class="n">param1</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">param2</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">param3</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">d4</span>

<span class="n">followed</span> <span class="n">by</span> <span class="k">for</span> <span class="n">each</span> <span class="n">nump</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d4</span><span class="p">)</span>

<span class="n">time</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">nump</span><span class="p">),</span> <span class="n">conc</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">nump</span><span class="p">)</span>

<span class="n">out_flag</span> <span class="p">(</span><span class="n">optional</span><span class="p">)</span> <span class="o">-</span> <span class="n">keyword</span> <span class="s2">&quot;out&quot;</span>
</pre></div>
</div>
<p>Please note that all fracture-fracture curves are input followed by fracture-matrix curves, followed by matrix-fracture curves, followed by matrix-matrix curves.</p>
</div>
<div class="section" id="optional-input-files">
<h2>Optional Input Files<a class="headerlink" href="#optional-input-files" title="Permalink to this headline">¶</a></h2>
<p>The data for any of the FEHM macros (with the exception of coor and elem, where use of a separate geometry input file is handled through control file input) may be entered in an alternate input file. To use this option the keyword ‘file’ must appear on the input line immediately following the control statement (macro name). The line immediately following this keyword will contain the name of the alternate input file. The contents of the alternate input file consist of the regular full macro description: the macro name followed by the data. Note that data from only one macro may be entered per auxilliary file. The entries in the optional input file may be preceded or followed by comments using the “#” designator (see discussion on <a href="#id12"><span class="problematic" id="id13">`Comments`_</span></a> may be entered in the input file by beginning a line with a ‘#’ symbol (the ‘#’ symbol must be found in the first column of the line). Comments may precede or follow macro blocks but may not be found within a block.). As with regular macro input, comments may not be embedded within the data block.</p>
<blockquote>
<div><p>Group 1 - <code class="docutils literal notranslate"><span class="pre">LOCKEYWORD</span></code></p>
<p>Group 2 - <code class="docutils literal notranslate"><span class="pre">LOCFILENAME</span></code></p>
</div></blockquote>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="16%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Input Variable</th>
<th class="head">Format</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>LOCKEYWORD</td>
<td>character*4</td>
<td>Keyword ‘file’ to designate an auxiliary input file is used.</td>
</tr>
<tr class="row-odd"><td>LOCFILENAME</td>
<td>character*100</td>
<td>Name of the optional data input file.</td>
</tr>
</tbody>
</table>
<p>The following illustrate the use of an optional input file and its contents. In this example, optional file “rockfile” is located in the current working directory. Input for macro “rock” is described in Control statement <a class="reference external" href="MacroRock.html">rock</a> (required).</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rock</span>
<span class="n">file</span>
<span class="n">rockfile</span>
</pre></div>
</div>
<p>File “rockfile”:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Auxiliary file used for rock macro input</span>
<span class="n">rock</span>
 <span class="mi">1</span>   <span class="mi">140</span>     <span class="mi">1</span>       <span class="mf">2563.</span>   <span class="mf">1010.</span>   <span class="mf">0.3500</span>

<span class="c1"># End of rock macro input</span>
</pre></div>
</div>
</div>
<div class="section" id="option-to-disable-a-macro">
<h2>Option to disable a macro<a class="headerlink" href="#option-to-disable-a-macro" title="Permalink to this headline">¶</a></h2>
<p>The data from any input macro may be omitted from a simulation by including the “off” keyword on the macro line and terminating the macro with an end macro statement. This also allows the inclusion of an end macro statement for any input macro. The end macro will follow the last specified line of input. If a macro is normally terminated with an end keyword, the macro id is appended to that keyword (an additional end macro line is not added). This facilitates experimentation with input options without the need to comment out or remove unwanted macros from the input file.</p>
<p>In the following example the perm macro is turned off and the hyco macro is used in its place.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">perm</span> <span class="n">off</span>
     <span class="mi">1</span>       <span class="mi">0</span>       <span class="mi">0</span>       <span class="mf">1.e-12</span>  <span class="mf">1.e-12</span>  <span class="mf">1.e-12</span>
<span class="n">end</span> <span class="n">perm</span>
<span class="n">hyco</span>
     <span class="mi">1</span>       <span class="mi">0</span>       <span class="mi">0</span>       <span class="mf">3.8e-3</span>  <span class="mf">3.8e-3</span>  <span class="mf">3.8e-3</span>
<span class="n">end</span> <span class="n">hyco</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Output.html" class="btn btn-neutral float-right" title="Output" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Macros/MacroZonn.html" class="btn btn-neutral float-left" title="zonn" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018, Los Alamos National Laboratory

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>